<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>GFAST: src/uw/beachball.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pnsn_icon.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFAST
   &#160;<span id="projectnumber">v0.01</span>
   </div>
   <div id="projectbrief">Fast geodetic computations for earthquake early warning</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('beachball_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">beachball.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="beachball_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;float.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gfast__config_8h.html">gfast_config.h</a>&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#ifdef GFAST_USE_INTEL</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;mkl_lapacke.h&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;mkl_cblas.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;cblas.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;lapacke.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;lapacke_utils.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;png.h&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="beachball_8h.html">beachball.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cmopad_8h.html">cmopad.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//#include &quot;pixmap.h&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//#include &quot;pixmap_png.h&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//#include &quot;pixmap_jpg.h&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#ifndef M_PI</span></div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">   24</a></span>&#160;<span class="preprocessor">#define M_PI 3.14159265358979323846</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#ifndef M_PI_2</span></div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="beachball_8c.html#a958e4508ed28ee5cc04249144312c15f">   27</a></span>&#160;<span class="preprocessor">#define M_PI_2 1.57079632679489661923</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#ifndef MAX</span></div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">   30</a></span>&#160;<span class="preprocessor">#define MAX(x,y) (((x) &gt; (y)) ? (x) : (y))</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#ifndef MIN</span></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">   33</a></span>&#160;<span class="preprocessor">#define MIN(x,y) (((x) &lt; (y)) ? (x) : (y))</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="beachball_8c.html#a328742b602af65206e7a7f17d577003a">   35</a></span>&#160;<span class="preprocessor">#define PIXMAP_COLORS 3</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> vecstrd(<span class="keyword">const</span> <span class="keywordtype">double</span> str, <span class="keyword">const</span> <span class="keywordtype">double</span> dip, <span class="keywordtype">double</span> r[3]);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> strdv(<span class="keyword">const</span> <span class="keywordtype">double</span> r[3], <span class="keywordtype">double</span> *str, <span class="keywordtype">double</span> *dip);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> crossp(<span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ u,</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ v,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                   <span class="keywordtype">double</span> *__restrict__ n);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> strdvec(<span class="keywordtype">double</span> r[3], <span class="keywordtype">double</span> *str, <span class="keywordtype">double</span> *dip);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> rotmat(<span class="keyword">const</span> <span class="keywordtype">int</span> naxis, <span class="keyword">const</span> <span class="keywordtype">double</span> theta,</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                   <span class="keywordtype">double</span> *__restrict__ r,</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                   <span class="keywordtype">double</span> *__restrict__ rt);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> isItNear(<span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ pt, </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                     <span class="keywordtype">double</span> *howClose,</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                     <span class="keywordtype">double</span> *__restrict__ ptold);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> dot3(<span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ x,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ y);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> gemv3(<span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ A, <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ x,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                  <span class="keywordtype">double</span> *__restrict__ y);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> transform(<span class="keyword">const</span> <span class="keywordtype">double</span> a, <span class="keyword">const</span> <span class="keywordtype">double</span> b,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> c, <span class="keyword">const</span> <span class="keywordtype">double</span> d,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> x);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="beachball_8h.html#a9dbfc6f1d8212299d3dd78fdf70766fb">   57</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="beachball_8c.html#a9dbfc6f1d8212299d3dd78fdf70766fb">beachball_setMomentTensor</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> m11, <span class="keyword">const</span> <span class="keywordtype">double</span> m22,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> m33, <span class="keyword">const</span> <span class="keywordtype">double</span> m12,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span> m13, <span class="keyword">const</span> <span class="keywordtype">double</span> m23,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                              <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="cmopad_8h.html#a493c4b9712b7f16e63fa48923ac8e51f">cmopad_basis_enum</a> basis,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                              <span class="keyword">struct</span> <a class="code" href="structbeachball_plot__struct.html">beachballPlot_struct</a> *beachball)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcmopad__struct.html">cmopad_struct</a> cmt;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">double</span> mt[3][3], m9[9], eigs[3];</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">int</span> ierr, info;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">bool</span> lexplosion, limplosion;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    memset(&amp;cmt, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structcmopad__struct.html">cmopad_struct</a>));</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// the edge case is for purely isotropic sources</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    lexplosion = <span class="keyword">false</span>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    limplosion = <span class="keyword">false</span>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    m9[0] = m11;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    m9[1] = m12;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    m9[2] = m13;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    m9[3] = m12;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    m9[4] = m22;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    m9[5] = m23;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    m9[6] = m13;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    m9[7] = m23;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    m9[8] = m33;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    info = LAPACKE_dsyev(LAPACK_COL_MAJOR, <span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;L&#39;</span>, 3, m9, 3, eigs);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (info != 0)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        printf(<span class="stringliteral">&quot;Failed classifying eigenvalues\n&quot;</span>);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> ((eigs[0] &gt; 0.0 &amp;&amp; eigs[1] &gt; 0.0 &amp;&amp; eigs[2] &gt; 0.0))</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {   </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="comment">//printf(&quot;Source is pure explosion\n&quot;); </span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        lexplosion = <span class="keyword">true</span>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> ((eigs[0] &lt; 0.0 &amp;&amp; eigs[1] &lt; 0.0 &amp;&amp; eigs[2] &lt; 0.0))</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {   </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        printf(<span class="stringliteral">&quot;Source is pure implosion\n&quot;</span>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        limplosion = <span class="keyword">true</span>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// copy the input moment tensor</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    mt[0][0] = m11;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    mt[1][1] = m22;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    mt[2][2] = m33;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    mt[0][1] = mt[1][0] = m12;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    mt[0][2] = mt[2][0] = m13;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    mt[1][2] = mt[2][1] = m23;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    ierr = <a class="code" href="cmopad_8c.html#aa193d08b096c71d5b0a812e76eae1122">cmopad_basis_transformMatrixM33</a>(mt, basis, <a class="code" href="cmopad_8h.html#a493c4b9712b7f16e63fa48923ac8e51fac25a68be23c83a9b7aee463b31527508">NED</a>);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (ierr != 0)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        printf(<span class="stringliteral">&quot;Error transforming matrix\n&quot;</span>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// decompose the moment tensor</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    ierr = <a class="code" href="cmopad_8c.html#ae9fa0569fb8fbbf71816d1680376bdef">cmopad_standardDecomposition</a>(mt, &amp;cmt);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (ierr != 0)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        printf(<span class="stringliteral">&quot;Failed initializing moment tensor from strike, dip, rake\n&quot;</span>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// get the principal tension, null, and plunge axes </span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    ierr = <a class="code" href="cmopad_8c.html#a1e15943c3bc19d926e75d06d03472576">cmopad_MT2PrincipalAxisSystem</a>(0, &amp;cmt);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (ierr != 0)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        printf(<span class="stringliteral">&quot;Error computing principal axes\n&quot;</span>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (lexplosion || limplosion)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        cmt.<a class="code" href="structcmopad__struct.html#aa87c78cc398ae1e60f4e584dfbb3aaab">p_axis</a>[2] = cmt.<a class="code" href="structcmopad__struct.html#afbb9fd85fd66e890203344fda2f250bc">eigenvalues</a>[0];</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        cmt.<a class="code" href="structcmopad__struct.html#aa32887859c59d9f2fd0bdcadeb64c0e3">null_axis</a>[2] = cmt.<a class="code" href="structcmopad__struct.html#afbb9fd85fd66e890203344fda2f250bc">eigenvalues</a>[1];</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        cmt.<a class="code" href="structcmopad__struct.html#a4dd2b1fb1d0c678e079f97c22336ad37">t_axis</a>[2] = cmt.<a class="code" href="structcmopad__struct.html#afbb9fd85fd66e890203344fda2f250bc">eigenvalues</a>[2];</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// Convert pressure, null, and tension principal axes to</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// azimuth, plunge, and length</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        ierr += <a class="code" href="cmopad_8c.html#ac72abee829040dcace74a0e66bd13be3">cmopad_Eigenvector2PrincipalAxis</a>(<a class="code" href="cmopad_8h.html#a493c4b9712b7f16e63fa48923ac8e51fac25a68be23c83a9b7aee463b31527508">NED</a>, cmt.<a class="code" href="structcmopad__struct.html#ad3d5d54e4aada8f0df5f9a8fcf553637">eig_pnt</a>[0],</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                                 cmt.<a class="code" href="structcmopad__struct.html#aa87c78cc398ae1e60f4e584dfbb3aaab">p_axis</a>,    cmt.<a class="code" href="structcmopad__struct.html#aa87c78cc398ae1e60f4e584dfbb3aaab">p_axis</a>);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        ierr += <a class="code" href="cmopad_8c.html#ac72abee829040dcace74a0e66bd13be3">cmopad_Eigenvector2PrincipalAxis</a>(<a class="code" href="cmopad_8h.html#a493c4b9712b7f16e63fa48923ac8e51fac25a68be23c83a9b7aee463b31527508">NED</a>, cmt.<a class="code" href="structcmopad__struct.html#ad3d5d54e4aada8f0df5f9a8fcf553637">eig_pnt</a>[1],</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                 cmt.<a class="code" href="structcmopad__struct.html#aa32887859c59d9f2fd0bdcadeb64c0e3">null_axis</a>, cmt.<a class="code" href="structcmopad__struct.html#aa32887859c59d9f2fd0bdcadeb64c0e3">null_axis</a>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        ierr += <a class="code" href="cmopad_8c.html#ac72abee829040dcace74a0e66bd13be3">cmopad_Eigenvector2PrincipalAxis</a>(<a class="code" href="cmopad_8h.html#a493c4b9712b7f16e63fa48923ac8e51fac25a68be23c83a9b7aee463b31527508">NED</a>, cmt.<a class="code" href="structcmopad__struct.html#ad3d5d54e4aada8f0df5f9a8fcf553637">eig_pnt</a>[2],</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                                 cmt.<a class="code" href="structcmopad__struct.html#a4dd2b1fb1d0c678e079f97c22336ad37">t_axis</a>,    cmt.<a class="code" href="structcmopad__struct.html#a4dd2b1fb1d0c678e079f97c22336ad37">t_axis</a>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">if</span> (ierr != 0)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            printf(<span class="stringliteral">&quot;Error converting eigenvector to principal axis!\n&quot;</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    memcpy(&amp;beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>, &amp;cmt, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structcmopad__struct.html">cmopad_struct</a>));</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a52469b7999db5653ce2b025951668210">lhaveMT</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="beachball_8h.html#afd07f77f5a7928e3fa2d0f4a9f46a692">  149</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="beachball_8c.html#af6b12ad0072637f30c4449c88757f76c">beachball_writePNG</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fileName,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                       <span class="keywordtype">size_t</span> height, <span class="keywordtype">size_t</span> width, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *bytes)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    FILE *file = NULL;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    png_structp png = NULL;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    png_infop info = NULL;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    png_bytepp rows = NULL;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">int</span> h;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    file = fopen(fileName, <span class="stringliteral">&quot;wb&quot;</span>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (file == NULL){printf(<span class="stringliteral">&quot;failed to open file\n&quot;</span>);}</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    png = png_create_write_struct(PNG_LIBPNG_VER_STRING, NULL, NULL, NULL);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (png == NULL){printf(<span class="stringliteral">&quot;error making png struct\n&quot;</span>);}</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    info = png_create_info_struct(png); </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> (info == NULL){printf(<span class="stringliteral">&quot;error making png info struct\n&quot;</span>);}</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    png_init_io(png, file);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    png_set_IHDR(png, info, width, height, 8,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                 PNG_COLOR_TYPE_RGB, PNG_INTERLACE_NONE,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                 PNG_COMPRESSION_TYPE_BASE, PNG_FILTER_TYPE_BASE);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    png_write_info(png, info);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    rows = calloc(height, <span class="keyword">sizeof</span>(png_bytep));</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">for</span> (h=0; h&lt;(int) height; h++)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        rows[h] = bytes + (<a class="code" href="beachball_8c.html#a328742b602af65206e7a7f17d577003a">PIXMAP_COLORS</a>*h*(int) width);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    png_write_rows(png, rows, height);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    png_write_end(png, NULL); <span class="comment">//info);</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    png_destroy_write_struct(&amp;png, &amp;info);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (rows != NULL){free(rows);}</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    fclose(file);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="beachball_8h.html#a8dad4077a4721003bfe4f652ec2d0609">  182</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="beachball_8c.html#a8dad4077a4721003bfe4f652ec2d0609">beachball_draw</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fileName,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                   <span class="keyword">struct</span> <a class="code" href="structbeachball_plot__struct.html">beachballPlot_struct</a> beachball)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *fcnm = <span class="stringliteral">&quot;beachball_draw\0&quot;</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbeach_ball__struct.html">beachBall_struct</a> beachImage;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *image;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">double</span> baz, bdp, bev, paz, pdp, pev, taz, tdp, tev, x, xnorm, y;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">int</span> i, i1, i2, indx, ix, iy, jy, k;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">size_t</span> npixel;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    taz = beachball.<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>.<a class="code" href="structcmopad__struct.html#a4dd2b1fb1d0c678e079f97c22336ad37">t_axis</a>[0];</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    tdp = beachball.<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>.<a class="code" href="structcmopad__struct.html#a4dd2b1fb1d0c678e079f97c22336ad37">t_axis</a>[1];</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    tev = beachball.<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>.<a class="code" href="structcmopad__struct.html#a4dd2b1fb1d0c678e079f97c22336ad37">t_axis</a>[2];</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    baz = beachball.<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>.<a class="code" href="structcmopad__struct.html#aa32887859c59d9f2fd0bdcadeb64c0e3">null_axis</a>[0];</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    bdp = beachball.<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>.<a class="code" href="structcmopad__struct.html#aa32887859c59d9f2fd0bdcadeb64c0e3">null_axis</a>[1];</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    bev = beachball.<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>.<a class="code" href="structcmopad__struct.html#aa32887859c59d9f2fd0bdcadeb64c0e3">null_axis</a>[2];</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    paz = beachball.<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>.<a class="code" href="structcmopad__struct.html#aa87c78cc398ae1e60f4e584dfbb3aaab">p_axis</a>[0];</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    pdp = beachball.<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>.<a class="code" href="structcmopad__struct.html#aa87c78cc398ae1e60f4e584dfbb3aaab">p_axis</a>[1];</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    pev = beachball.<a class="code" href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">cmt</a>.<a class="code" href="structcmopad__struct.html#aa87c78cc398ae1e60f4e584dfbb3aaab">p_axis</a>[2];</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// normalize the moment tensor for my sanity</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    xnorm = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(fabs(tev), <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(fabs(bev), fabs(pev)));</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (xnorm == 0.0)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        printf(<span class="stringliteral">&quot;%s: Error normalization is zero %f %f %f\n&quot;</span>, fcnm, tev, bev, pev);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">return</span> -1; </div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// compute everything describing the beachball </span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    memset(&amp;beachImage, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structbeach_ball__struct.html">beachBall_struct</a>));</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="beachball_8c.html#ac7c2236111e9175c69d730131a8df4c9">cliffsNodes_beachBallP</a>(beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a>, beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a>, beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                           taz, tdp, tev,</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                           baz, bdp, bev,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                           paz, pdp, pev,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                           beachball.<a class="code" href="structbeachball_plot__struct.html#a9037c106a7918beb799a798569952e16">nNodalLine</a>,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                           beachball.<a class="code" href="structbeachball_plot__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">nFocalSphere</a>,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                           beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>, beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                           <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>,</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                           &amp;beachImage);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// draw the image</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    npixel = (size_t) (beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>*beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    image = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            calloc(<a class="code" href="beachball_8c.html#a328742b602af65206e7a7f17d577003a">PIXMAP_COLORS</a>*npixel, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>));</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// Set a white background</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">for</span> (indx=0; indx&lt;3*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>*beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>; indx++)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        image[indx] = 255;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    } </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// Draw the polarity</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (beachball.<a class="code" href="structbeachball_plot__struct.html#a5f2dee54ae7b27277545443af6fda96a">lwantPolarity</a>)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    {    </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">for</span> (i=0; i&lt;beachImage.<a class="code" href="structbeach_ball__struct.html#ae2c993a67248339ca041a2daf13fcf89">npolarity</a>; i++) </div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            x = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                          beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                          0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>-1),</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                          beachImage.<a class="code" href="structbeach_ball__struct.html#a5d16c92e39b01e34aa44dc0fba4fcd9d">xPolarity</a>[i]);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            y = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                          beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                          0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>-1),</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                          beachImage.<a class="code" href="structbeach_ball__struct.html#a098567845b40d00d3bac256a61916c21">yPolarity</a>[i]);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            ix = (int) (x + 0.5);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            iy = (int) (y + 0.5);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            ix = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(ix, beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a> - 1)); </div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            iy = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(iy, beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1)); </div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            jy = beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1 - iy;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span> (beachImage.<a class="code" href="structbeach_ball__struct.html#af23ae8fe9b61d7f66813fdb9f93daaf3">polarity</a>[i] ==-1)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="comment">// white</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+0] = 255; </div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+1] = 255; </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+2] = 255; </div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="comment">// red</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+0] = 255; </div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+1] = 0; </div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+2] = 0; </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// Add the nodal lines</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (beachball.<a class="code" href="structbeachball_plot__struct.html#a67ceb94f2cf4f755e4d8703624ba447e">lwantNodalLines</a>)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="comment">// draw first nodal line</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;beachImage.<a class="code" href="structbeach_ball__struct.html#ae5118884cd104f1662bad29cd32bb2aa">nNodalLineSegs1</a>; k++)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            i1 = beachImage.<a class="code" href="structbeach_ball__struct.html#aed28f64861afc74fcac34db801f2fe3e">nodalLine1Ptr</a>[k];</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            i2 = beachImage.<a class="code" href="structbeach_ball__struct.html#aed28f64861afc74fcac34db801f2fe3e">nodalLine1Ptr</a>[k+1];</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">for</span> (i=i1; i&lt;i2; i++)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="comment">// start point in vector (line)</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                x = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                              beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                              0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>-1),</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                              beachImage.<a class="code" href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">xNodalLine1</a>[2*i]);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                y = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                              beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                              0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>-1),</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                              beachImage.<a class="code" href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">yNodalLine1</a>[2*i]);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                ix = (int) (x + 0.5);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                iy = (int) (y + 0.5);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                ix = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(ix, beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a> - 1));</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                iy = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(iy, beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1));</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                jy = beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1 - iy;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="comment">// black</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+0] = 0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+1] = 0;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+2] = 0;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <span class="comment">// end point in vector (line)</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                x = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                              beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                              0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>-1),</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                              beachImage.<a class="code" href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">xNodalLine1</a>[2*i+1]);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                y = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                              beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                              0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>-1),</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                              beachImage.<a class="code" href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">yNodalLine1</a>[2*i+1]);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                ix = (int) (x + 0.5);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                iy = (int) (y + 0.5);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                ix = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(ix, beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a> - 1));</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                iy = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(iy, beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1));</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                jy = beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1 - iy;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="comment">// black</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+0] = 0;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+1] = 0;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+2] = 0;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">// draw second nodal line</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;beachImage.<a class="code" href="structbeach_ball__struct.html#ada579aea1b865d64386b70b0f42c65d2">nNodalLineSegs2</a>; k++) </div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            i1 = beachImage.<a class="code" href="structbeach_ball__struct.html#aeca1929302c7683f529bbaf185bf8cdc">nodalLine2Ptr</a>[k];</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            i2 = beachImage.<a class="code" href="structbeach_ball__struct.html#aeca1929302c7683f529bbaf185bf8cdc">nodalLine2Ptr</a>[k+1];</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">for</span> (i=i1; i&lt;i2; i++) </div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="comment">// start point in vector (line)</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                x = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                              beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                              0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>-1),</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                              beachImage.<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a>[2*i]);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                y = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                              beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                              0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>-1),</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                              beachImage.<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a>[2*i]);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                ix = (int) (x + 0.5);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                iy = (int) (y + 0.5);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                ix = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(ix, beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a> - 1)); </div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                iy = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(iy, beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1)); </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                jy = beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1 - iy;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="comment">// black</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+0] = 0; </div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+1] = 0; </div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+2] = 0; </div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="comment">// end point in vector (line)</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                x = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                              beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                              0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>-1),</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                              beachImage.<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a>[2*i+1]);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                y = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                              beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                              0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>-1),</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                              beachImage.<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a>[2*i+1]);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                ix = (int) (x + 0.5);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                iy = (int) (y + 0.5);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                ix = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(ix, beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a> - 1)); </div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                iy = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(iy, beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1)); </div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                jy = beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1 - iy;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="comment">// black</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+0] = 0; </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+1] = 0; </div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+2] = 0; </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Draw an outline</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;beachImage.<a class="code" href="structbeach_ball__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">nFocalSphere</a>; i++)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        x = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                      beachball.<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                      0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>-1),</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                      beachImage.<a class="code" href="structbeach_ball__struct.html#ad85c80e168676b8e530babeb8696c939">xFocalSphere</a>[i]);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        y = transform(beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> - beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                      beachball.<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> + beachball.<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a>,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                      0, (<span class="keywordtype">double</span>) (beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>-1),</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                      beachImage.<a class="code" href="structbeach_ball__struct.html#a9fa03171ed7fd073882543c4a26fb6b8">yFocalSphere</a>[i]);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        ix = (int) (x + 0.5);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        iy = (int) (y + 0.5);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        ix = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(ix, beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a> - 1));</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        iy = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(0, <a class="code" href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a>(iy, beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1));</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        jy = beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> - 1 - iy;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">// black</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+0] = 0;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+1] = 0;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        image[3*(jy*beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>+ix)+2] = 0;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// Write it</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="beachball_8c.html#af6b12ad0072637f30c4449c88757f76c">beachball_writePNG</a>(fileName,</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                       (<span class="keywordtype">size_t</span>) beachball.<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>, (<span class="keywordtype">size_t</span>) beachball.<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a>,</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                       image);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    free(image);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="beachball_8c.html#acebc8325fc27dd441e210779f534d77e">cliffsNodes_free</a>(&amp;beachImage);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="beachball_8h.html#a1473891ec4d8ea3e50df08eef9d1d6b8">  385</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="beachball_8c.html#a1473891ec4d8ea3e50df08eef9d1d6b8">beachball_plotDefaults</a>(<span class="keyword">struct</span> <a class="code" href="structbeachball_plot__struct.html">beachballPlot_struct</a> *beachball)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;{</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    memset(beachball, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structbeachball_plot__struct.html">beachballPlot_struct</a>));</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">rad</a> = 1.0;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">xc</a> = 1.5;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">yc</a> = 1.5;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a> = 251;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">nyPixel</a> = 251;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a9037c106a7918beb799a798569952e16">nNodalLine</a> = 3*beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">nFocalSphere</a> = 4*beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">nxPixel</a>;   </div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a5f2dee54ae7b27277545443af6fda96a">lwantPolarity</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a67ceb94f2cf4f755e4d8703624ba447e">lwantNodalLines</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    beachball-&gt;<a class="code" href="structbeachball_plot__struct.html#a52469b7999db5653ce2b025951668210">lhaveMT</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> transform(<span class="keyword">const</span> <span class="keywordtype">double</span> a, <span class="keyword">const</span> <span class="keywordtype">double</span> b,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> c, <span class="keyword">const</span> <span class="keywordtype">double</span> d,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> x)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">double</span> det, c1, c2, xi;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    det = 1.0/(b - a);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    c1 = det*(b*c - a*d);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    c2 = det*(-c + d);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    xi = c1 + x*c2;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">return</span> xi;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">//============================================================================//</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordtype">int</span> <a class="code" href="beachball_8c.html#aee0f6746393f5d6284fc925237f39703">cliffsNodes_plotStations</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xc, <span class="keyword">const</span> <span class="keywordtype">double</span> yc, <span class="keyword">const</span> <span class="keywordtype">double</span> rad,</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">int</span> nstat, </div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ az, </div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ toa,</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                             <span class="keywordtype">double</span> *__restrict__ <a class="code" href="structbeach_ball__struct.html#af649efec4c4f51f4db0ebb935a83d015">xp</a>, </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                             <span class="keywordtype">double</span> *__restrict__ <a class="code" href="structbeach_ball__struct.html#a7841edcbdbfea2b400dea7753dcfac9e">yp</a>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="beachball_8c.html#aee0f6746393f5d6284fc925237f39703">  441</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="beachball_8c.html#aee0f6746393f5d6284fc925237f39703">cliffsNodes_plotStations</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xc, <span class="keyword">const</span> <span class="keywordtype">double</span> yc, <span class="keyword">const</span> <span class="keywordtype">double</span> rad,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">int</span> nstat, </div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ az,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ toa,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                             <span class="keywordtype">double</span> *__restrict__ <a class="code" href="structbeach_ball__struct.html#af649efec4c4f51f4db0ebb935a83d015">xp</a>,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                             <span class="keywordtype">double</span> *__restrict__ <a class="code" href="structbeach_ball__struct.html#a7841edcbdbfea2b400dea7753dcfac9e">yp</a>)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;{</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *fcnm = <span class="stringliteral">&quot;cliffsNodes_plotStations\0&quot;</span>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordtype">double</span> azrad, rp, sign, toaN;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> sqrt2 = 1.4142135623730951;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> degrad = <a class="code" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">//------------------------------------------------------------------------//</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// error handling</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> (nstat &lt; 1 || az == NULL || toa == NULL || xp == NULL || yp == NULL)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">if</span> (nstat &lt; 1){printf(<span class="stringliteral">&quot;%s: No stations\n&quot;</span>, fcnm);}</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">if</span> (az == NULL){printf(<span class="stringliteral">&quot;%s: az is NULL\n&quot;</span>, fcnm);}</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">if</span> (toa == NULL){printf(<span class="stringliteral">&quot;%s: toa is NULL\n&quot;</span>, fcnm);}</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">if</span> (xp == NULL){printf(<span class="stringliteral">&quot;%s: xp is NULL\n&quot;</span>, fcnm);}</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">if</span> (yp == NULL){printf(<span class="stringliteral">&quot;%s: yp is NULL\n&quot;</span>, fcnm);}</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// compute point on focal shere for each station</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;nstat; i++)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">// ray normally goes down</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        sign = 1.0;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        toaN = toa[i];</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="comment">// ray is going up</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span> (toaN &gt; 90.)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            toaN = 180. - toa[i];</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            sign =-1.;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        rp = sign*rad*sqrt2*sin(0.5*degrad*toaN);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        azrad = az[i]*degrad;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        xp[i] = xc + rp*sin(azrad);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        yp[i] = yc + rp*cos(azrad);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">//============================================================================//</span></div><div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="beachball_8h.html#a394f716524aaf5687a294a614b85a2d8">  510</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="beachball_8c.html#a394f716524aaf5687a294a614b85a2d8">cliffsNodes_mtensor</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> taz, <span class="keyword">const</span> <span class="keywordtype">double</span> tdp,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">double</span> paz, <span class="keyword">const</span> <span class="keywordtype">double</span> pdp,</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">double</span> tev1, <span class="keyword">const</span> <span class="keywordtype">double</span> bev1,</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">double</span> pev1,</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                         <span class="keywordtype">double</span> *__restrict__ mt,</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                         <span class="keywordtype">double</span> *__restrict__ rm,</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                         <span class="keywordtype">double</span> *__restrict__ rmt,</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                         <span class="keywordtype">double</span> *ampMax)</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;{                             </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordtype">double</span> mpt[9], sm1[9], smt1[9], sm2[9], smt2[9],  sm3[9],</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;           smt3[9], work[9], p[3], pnew[3], pxt[3], t[3], pang;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> degrad = <a class="code" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// set up moment tensor in t-p system</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    memset(mpt, 0, 9*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    mpt[0] = tev1;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    mpt[4] = pev1;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    mpt[8] = bev1;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// condition p-axis so that it really is perpendicular to t-axis</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    vecstrd(taz, tdp, t);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    vecstrd(paz, pdp, p);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    crossp(p, t, pxt);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    crossp(t, pxt, p);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// Step 1: rotate 1-axis about 3-axis so that 1-axis lies along t azimuth</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    rotmat(3, taz-90., sm1, smt1);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// Step 2: rotate 1-axis about 2-axis so that 1-axis liesalong t</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    rotmat(2, tdp, sm2, smt2);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    cblas_dgemm(CblasColMajor, CblasNoTrans, CblasNoTrans, 3, 3, 3,</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                1.0, sm2, 3, sm1, 3, 0.0, sm3, 3); </div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    cblas_dgemm(CblasColMajor, CblasNoTrans, CblasNoTrans, 3, 3, 3,</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                1.0, smt1, 3, smt2, 3, 0.0, smt3, 3);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// in this system, p should lie in 2-3 plane</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    cblas_dgemv(CblasColMajor, CblasNoTrans, 3, 3,</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                1.0, sm3, 3, p, 1, 0.0, pnew, 1); </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// Step 3: rotate about 1 axis so that 2 axis lies along p</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    pang = atan2(pnew[2], pnew[1])/degrad; <span class="comment">//(3.14159/180.)</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    rotmat(1, -pang, sm1, smt1);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    cblas_dgemm(CblasColMajor, CblasNoTrans, CblasNoTrans, 3, 3, 3,</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                1.0, sm1, 3, sm3, 3, 0.0, rm, 3); </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    cblas_dgemm(CblasColMajor, CblasNoTrans, CblasNoTrans, 3, 3, 3,</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                1.0, smt3, 3, smt1, 3, 0.0, rmt, 3);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// Finally: find moment tensor in space coordinates.</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// This is because Mpt=RM*Mspace*RMT, thus Mspace=RMT*Mpt*RM</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    cblas_dgemm(CblasColMajor, CblasNoTrans, CblasNoTrans, 3, 3, 3,</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                1.0, rmt, 3, mpt, 3, 0.0, work, 3);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    cblas_dgemm(CblasColMajor, CblasNoTrans, CblasNoTrans, 3, 3, 3,</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                1.0, work, 3, rm, 3, 0.0, mt, 3);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">// ampMax is the absolute maximum amplitude</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    *ampMax = <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(fabs(pev1), <a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(fabs(tev1),  fabs(bev1)));</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">//============================================================================//</span></div><div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="beachball_8h.html#ac7c2236111e9175c69d730131a8df4c9">  601</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="beachball_8c.html#ac7c2236111e9175c69d730131a8df4c9">cliffsNodes_beachBallP</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> xc, <span class="keyword">const</span> <span class="keywordtype">double</span> yc, <span class="keyword">const</span> <span class="keywordtype">double</span> rad,</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">double</span> taz1, <span class="keyword">const</span> <span class="keywordtype">double</span> tdp1,</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">double</span> tevI,</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">double</span> baz1, <span class="keyword">const</span> <span class="keywordtype">double</span> bdp1,</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">double</span> bevI,</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">double</span> paz1, <span class="keyword">const</span> <span class="keywordtype">double</span> pdp1,</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">double</span> pevI,</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">int</span> nNodalLine,</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structbeach_ball__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">nFocalSphere</a>,</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">int</span> nxPixel, <span class="keyword">const</span> <span class="keywordtype">int</span> nyPixel,</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">bool</span> lwantNodalLines,</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">bool</span> lwantPTBAxes,</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">bool</span> lwantPolarity,</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                            <span class="keyword">struct</span> <a class="code" href="structbeach_ball__struct.html">beachBall_struct</a> *beachBall)</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;{</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordtype">double</span> *xw1, *xw2, *yw1, *yw2;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordtype">double</span> rm[9] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordtype">double</span> rmt[9] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordtype">double</span> tm[9] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordtype">double</span> pt[3] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordtype">double</span> ptnew[3] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordtype">double</span> ax1[3] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordtype">double</span> ax2[3] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordtype">double</span> ax3[3] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordtype">double</span> ptLine1[3] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">double</span> ptLine2[3] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">double</span> ptLine1Old[3] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordtype">double</span> ptLine2Old[3] __attribute__ ((aligned(64)));</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">double</span> ampMax, az, baz, bdp, bev, cosPsi, cosTheta, </div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;           dip, dp, dpsi, dx, dy, evI, fclvd, fIso, howClose, rad2,</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;           rb, rp, rpt, rpt2, rt, paz, pdp, pev, plusMin, psi,</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;           sinsq, sinPsi, sinTheta, str,</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;           taz, tdp, tev, theta, x, x0, xpt, y, y0, ypt;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordtype">int</span> *pn1, *pn2, ix, ixy, iy, k, nlines, nnl1, nnl2, npts, nseg,</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        nx, ny, penDown, psave1, psave2;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordtype">size_t</span> nwork;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> sqrt2 = 1.4142135623730951;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> sqrt2i = 1.0/sqrt2;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> degrad = <a class="code" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> degradi = 180.0/<a class="code" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>; </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> third = 1.0/3.0;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> tol = 0.95;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// null out result</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    memset(beachBall, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structbeach_ball__struct.html">beachBall_struct</a>));</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// Avoid overwriting memory</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    taz = taz1;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    tdp = tdp1;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    baz = baz1;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    bdp = bdp1;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    paz = paz1;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    pdp = pdp1;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// Step 1: set up axes:</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">//  - D axis (&#39;dominant&#39; 1-axis - with largest absolute eigenvalue)</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">//  - M axis (&#39;minor&#39;    3-axis)</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">//  - B axis (           2-axis)</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    evI = (tevI + bevI + pevI)*third;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    tev = tevI - evI;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    bev = bevI - evI;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    pev = pevI - evI;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    vecstrd(paz, pdp, ax1);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    vecstrd(taz, tdp, ax3);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    fclvd = fabs(bev/pev);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    fIso = evI/pev;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">if</span> (fabs(tev) &gt; fabs(pev))</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        vecstrd(taz, tdp, ax1);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        vecstrd(paz, pdp, ax3);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        fclvd = fabs(bev/tev);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        fIso = evI/tev;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">//if (fabs(evI) &gt; .03) </span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">//{</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">//    write(6,901) evI</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">//}</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    crossp(ax1, ax3, ax2);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    strdvec(ax2, &amp;baz, &amp;bdp);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="beachball_8c.html#a394f716524aaf5687a294a614b85a2d8">cliffsNodes_mtensor</a>(taz, tdp, paz, pdp, tevI, bevI, pevI,</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                        tm, rm, rmt, &amp;ampMax);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// Step 2: Now: plot upper half nodal line:</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// point on nodal line is represented by vector pt;</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">//  pt is defined by two angles </span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">//  - psi is azimuth with respect to 3-axis (M-axis) </span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="comment">//    in 2-3 plane (in B-M plane)</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">//  - theta is angle with respect to 1 axis.</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">// It can be shown (i. e., cliff did it once) that:</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">//   sin(theta)**2=(2+2*fIso)/(3+(1-2*f)*cos(2*psi))</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// Additionally, a constraint corresponding to Cliff&#39;s Rule 1</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">// for existance of P nodal planes is applied</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">//psi = 0.;</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">//dpsi = 2.;</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">//npts  = nNodalLine1; //1 + (int)(360.0/dpsi + 0.5); //nint((360./dpsi))</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">//dpsi = dpsi*degrad;</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    psave1 =-1;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    psave2 =-1;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    memset(ptLine1Old, 0, 3*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    memset(ptLine2Old, 0, 3*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">if</span> (lwantNodalLines &amp;&amp; nNodalLine &gt; 1 &amp;&amp;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        !(tevI &gt; 0.0 &amp;&amp; bevI &gt; 0.0 &amp;&amp; pevI &gt; 0.0) &amp;&amp;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        !(tevI &lt; 0.0 &amp;&amp; bevI &lt; 0.0 &amp;&amp; pevI &lt; 0.0))</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        npts = nNodalLine;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        psi = 0.0;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        dpsi = 360.0/(double) (nNodalLine - 1);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        dpsi = dpsi*degrad;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        xw1 = (<span class="keywordtype">double</span> *) calloc((<span class="keywordtype">size_t</span>) npts, <span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        yw1 = (<span class="keywordtype">double</span> *) calloc((<span class="keywordtype">size_t</span>) npts, <span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        pn1 = (<span class="keywordtype">int</span> *) calloc((<span class="keywordtype">size_t</span>) npts+1, <span class="keyword">sizeof</span>(int));</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        xw2 = (<span class="keywordtype">double</span> *) calloc((<span class="keywordtype">size_t</span>) npts, <span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        yw2 = (<span class="keywordtype">double</span> *) calloc((<span class="keywordtype">size_t</span>) npts, <span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        pn2 = (<span class="keywordtype">int</span> *) calloc((<span class="keywordtype">size_t</span>) npts+1, <span class="keyword">sizeof</span>(int));</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        nnl1 = 0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        nnl2 = 0;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;npts; k++)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            psi = k*dpsi;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            theta = 0.0;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            sinsq = (2. + 2.*fIso)/(3. + (1. - 2.*fclvd)*cos(2.*psi));</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordflow">if</span> (sinsq &gt; 0 &amp;&amp; sinsq &lt;= 1.0)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                theta = asin(sqrt(sinsq));</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                cosTheta = cos(theta);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                sinTheta = sin(theta);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                cosPsi = cos(psi);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                sinPsi = sin(psi);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="comment">// upper half nodal line</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                ptLine1[0] = cosTheta*ax1[0] </div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                           + sinTheta*(sinPsi*ax2[0] + cosPsi*ax3[0]);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                ptLine1[1] = cosTheta*ax1[1]</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                           + sinTheta*(sinPsi*ax2[1] + cosPsi*ax3[1]);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                ptLine1[2] = cosTheta*ax1[2]</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                           + sinTheta*(sinPsi*ax2[2] + cosPsi*ax3[2]);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="comment">// lower half nodal line</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                ptLine2[0] =-cosTheta*ax1[0]</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                           - sinTheta*(sinPsi*ax2[0] + cosPsi*ax3[0]);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                ptLine2[1] =-cosTheta*ax1[1]</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                           - sinTheta*(sinPsi*ax2[1] + cosPsi*ax3[1]);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                ptLine2[2] =-cosTheta*ax1[2]</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                           - sinTheta*(sinPsi*ax2[2] + cosPsi*ax3[2]);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                isItNear(ptLine1, &amp;howClose, ptLine1Old);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="comment">// upper half nodal line</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                penDown =-1;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <span class="keywordflow">if</span> (ptLine1[2] &lt; 0.0){penDown = 1;}</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">if</span> (howClose &lt; tol){penDown =-1;}</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                strdv(ptLine1, &amp;str, &amp;dip);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                rpt = rad*sqrt2*sin(0.5*degrad*(90.-dip));</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                xpt = xc + rpt*sin(str*degrad);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                ypt = yc + rpt*cos(str*degrad);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                xw1[k] = xpt;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                yw1[k] = ypt;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <span class="keywordflow">if</span> (k == 0){pn1[k] = 3;}</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <span class="keywordflow">if</span> (penDown == 1 &amp;&amp; psave1 == 1)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                    pn1[k] = 2;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    <span class="comment">//printf(&quot;%f %f\n&quot;, xpt, ypt);</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <span class="keywordflow">if</span> (penDown ==-1){pn1[k] = 3;}</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                nnl1 = nnl1 + 1;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                psave1 = penDown;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                <span class="comment">// lower half nodal line</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                penDown =-1;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                <span class="keywordflow">if</span> (ptLine2[2] &lt; 0.0){penDown = 1;} </div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                <span class="keywordflow">if</span> (howClose &lt; tol){penDown =-1;}</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                strdv(ptLine2, &amp;str, &amp;dip);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                rpt = rad*sqrt2*sin(0.5*degrad*(90.-dip));</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                xpt = xc + rpt*sin(str*degrad);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                ypt = yc + rpt*cos(str*degrad);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                xw2[k] = xpt;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                yw2[k] = ypt;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keywordflow">if</span> (k == 0){pn2[k] = 3;} <span class="comment">// pen down</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <span class="keywordflow">if</span> (penDown == 1 &amp;&amp; psave2 == 1)</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    pn2[k] = 2;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    <span class="comment">//xptsLine2[k] = xpt;</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    <span class="comment">//yptsLine2[k] = ypt;</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    <span class="comment">//penLine2[k] = penDwn;</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                }</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="keywordflow">if</span> (penDown ==-1){pn2[k] = 3;}</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                nnl2 = nnl2 + 1;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                psave2 = penDown;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        } <span class="comment">// loop on points</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        nwork = (size_t) (<a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(2, 2*nnl1));</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">xNodalLine1</a> = (<span class="keywordtype">double</span> *) calloc(nwork, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">yNodalLine1</a> = (<span class="keywordtype">double</span> *) calloc(nwork, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        nwork = (size_t) (nnl1 + 1);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#aed28f64861afc74fcac34db801f2fe3e">nodalLine1Ptr</a> = (<span class="keywordtype">int</span> *) calloc(nwork, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        nwork = (size_t) (<a class="code" href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(2, 2*nnl2));</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a> = (<span class="keywordtype">double</span> *) calloc(nwork, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a> = (<span class="keywordtype">double</span> *) calloc(nwork, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        nwork = (size_t) (nnl2 + 1);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#aeca1929302c7683f529bbaf185bf8cdc">nodalLine2Ptr</a> = (<span class="keywordtype">int</span> *) calloc(nwork, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="comment">// make sure the lines end</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        pn1[nnl1] = 3;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        pn2[nnl2] = 3;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">// compute the nodal line 1 line segments </span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        nlines = 0;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        nseg = 0;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;nnl1; k++)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="comment">// line begins</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <span class="keywordflow">if</span> (pn1[k] == 3 &amp;&amp; pn1[k+1] == 2)</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">xNodalLine1</a>[2*nlines  ] = xw1[k];</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">xNodalLine1</a>[2*nlines+1] = xw1[k+1]; </div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">yNodalLine1</a>[2*nlines  ] = yw1[k];</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">yNodalLine1</a>[2*nlines+1] = yw1[k+1];</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                nlines = nlines + 1;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            }</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="comment">// line continues</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="keywordflow">if</span> (pn1[k] == 2 &amp;&amp; pn1[k+1] == 2)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">xNodalLine1</a>[2*nlines  ] = xw1[k];</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">xNodalLine1</a>[2*nlines+1] = xw1[k+1]; </div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">yNodalLine1</a>[2*nlines  ] = yw1[k];</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">yNodalLine1</a>[2*nlines+1] = yw1[k+1];</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                nlines = nlines + 1;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="comment">// line ends </span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="keywordflow">if</span> (pn1[k] == 2 &amp;&amp; pn1[k+1] == 3)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">                beachBall-&gt;xNodalLine1[2*nlines  ] = xw1[k];</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">                beachBall-&gt;xNodalLine1[2*nlines+1] = xw1[k+1]; </span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">                beachBall-&gt;yNodalLine1[2*nlines  ] = yw1[k];</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">                beachBall-&gt;yNodalLine1[2*nlines+1] = yw1[k+1];</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">                nlines = nlines + 1;</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                nseg = nseg + 1;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#aed28f64861afc74fcac34db801f2fe3e">nodalLine1Ptr</a>[nseg] = nlines;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        }</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ae5118884cd104f1662bad29cd32bb2aa">nNodalLineSegs1</a> = nseg;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="comment">// compute the nodal line 2 line segments </span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        nlines = 0;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        nseg = 0;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;nnl2; k++)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="comment">// line begins</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keywordflow">if</span> (pn2[k] == 3 &amp;&amp; pn2[k+1] == 2)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a>[2*nlines  ] = xw2[k];</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a>[2*nlines+1] = xw2[k+1]; </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a>[2*nlines  ] = yw2[k];</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a>[2*nlines+1] = yw2[k+1];</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                nlines = nlines + 1;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="comment">// line continues</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="keywordflow">if</span> (pn2[k] == 2 &amp;&amp; pn2[k+1] == 2)</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a>[2*nlines  ] = xw2[k];</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a>[2*nlines+1] = xw2[k+1]; </div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a>[2*nlines  ] = yw2[k];</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a>[2*nlines+1] = yw2[k+1];</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                nlines = nlines + 1;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <span class="comment">// line ends </span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <span class="keywordflow">if</span> (pn2[k] == 2 &amp;&amp; pn2[k+1] == 3)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            {</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a>[2*nlines  ] = xw2[k];</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a>[2*nlines+1] = xw2[k+1]; </div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a>[2*nlines  ] = yw2[k];</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a>[2*nlines+1] = yw2[k+1];</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                nlines = nlines + 1;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                nseg = nseg + 1;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#aeca1929302c7683f529bbaf185bf8cdc">nodalLine2Ptr</a>[nseg] = nlines;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ada579aea1b865d64386b70b0f42c65d2">nNodalLineSegs2</a> = nseg;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">//printf(&quot;%d %d\n&quot;, nlines, nseg);</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        free(pn1);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        free(pn2);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        free(xw1);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        free(xw2);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        free(yw1);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        free(yw2);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// Step 4: Plot the, P, T, and B axes</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">if</span> (lwantPTBAxes)</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        rp = rad*sqrt2*sin(0.5*degrad*(90.-pdp));</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        rt = rad*sqrt2*sin(0.5*degrad*(90.-tdp));</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        rb = rad*sqrt2*sin(0.5*degrad*(90.-bdp));</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#af649efec4c4f51f4db0ebb935a83d015">xp</a> = xc + rp*sin(paz*degrad);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a7841edcbdbfea2b400dea7753dcfac9e">yp</a> = yc + rp*cos(paz*degrad);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a5b5d4f3c9ef8cbf20bff18ddd1b04609">xt</a> = xc + rt*sin(taz*degrad);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad64a753b0b96448e6fafb8b9d20c26e0">yt</a> = yc + rt*cos(taz*degrad);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ae78ecf4e64643bcfc6a3b4405d856f5c">xb</a> = xc + rb*sin(baz*degrad);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a363478c63dde84a67ebcd5d3ca1fbda2">yb</a> = yc + rb*cos(baz*degrad);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">// Step 5: Plot the focal sphere</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">if</span> (nFocalSphere &gt; 1)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">nFocalSphere</a> = <a class="code" href="structbeach_ball__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">nFocalSphere</a>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad85c80e168676b8e530babeb8696c939">xFocalSphere</a> = (<span class="keywordtype">double</span> *)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                  calloc((<span class="keywordtype">size_t</span>) <a class="code" href="structbeach_ball__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">nFocalSphere</a>, <span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a9fa03171ed7fd073882543c4a26fb6b8">yFocalSphere</a> = (<span class="keywordtype">double</span> *)</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                                  calloc((<span class="keywordtype">size_t</span>) <a class="code" href="structbeach_ball__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">nFocalSphere</a>, <span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        dpsi = 2.0*<a class="code" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/(double) (nFocalSphere - 1);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="preprocessor">        #pragma omp simd</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;<a class="code" href="structbeach_ball__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">nFocalSphere</a>; k++)</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            psi = (double) k*dpsi;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad85c80e168676b8e530babeb8696c939">xFocalSphere</a>[k] = xc + rad*sin(psi);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a9fa03171ed7fd073882543c4a26fb6b8">yFocalSphere</a>[k] = yc + rad*cos(psi);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        } </div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">// Step 6: Plot the + and -</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">if</span> (lwantPolarity &amp;&amp; nxPixel &gt; 0 &amp;&amp; nyPixel &gt; 0)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="comment">// begin in lower left corner</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        nx = nxPixel;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        ny = nyPixel;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        dx = 2.0*rad/(double) (nx - 1); </div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        dy = 2.0*rad/(double) (ny - 1);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        x0 = xc - rad;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        y0 = yc - rad;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        rad2 = rad*rad; <span class="comment">// saves a sqrt computation when comparing distances</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        xw1 = (<span class="keywordtype">double</span> *)calloc((<span class="keywordtype">size_t</span>) (nx*ny), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        yw1 = (<span class="keywordtype">double</span> *)calloc((<span class="keywordtype">size_t</span>) (nx*ny), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        pn1 = (<span class="keywordtype">int</span> *)calloc((<span class="keywordtype">size_t</span>) (nx*ny), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));        </div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        nwork = 0;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="comment">// loop on pixel grid</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">for</span> (iy=0; iy&lt;ny; iy++)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keywordflow">for</span> (ix=0; ix&lt;nx; ix++)</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                x = x0 + (double) ix*dx;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                y = y0 + (double) iy*dy;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                k = iy*nx + ix;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                pn1[k] = 0;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                xw1[k] = x;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                yw1[k] = y;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                <span class="comment">// require (x,y) be in the focal sphere</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                rpt2 = pow(x - xc, 2) + pow(y - yc, 2);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                <span class="keywordflow">if</span> (rpt2 &lt; rad2)</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                {</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                    nwork = nwork + 1;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                    rpt = sqrt(rpt2);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                    <span class="comment">// compute the azimuth</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                    theta = atan2(y - yc, x - xc);  <span class="comment">// measure from x axis</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                    az = (<a class="code" href="beachball_8c.html#a958e4508ed28ee5cc04249144312c15f">M_PI_2</a> - theta)*degradi;  <span class="comment">// az is measured from north</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                    <span class="keywordflow">if</span> (az &lt; 0.0){az = az + 360.0;} <span class="comment">// convention is [0,360]</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    <span class="comment">// compute the dip</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    dp = (<a class="code" href="beachball_8c.html#a958e4508ed28ee5cc04249144312c15f">M_PI_2</a> - 2.0*asin(rpt*sqrt2i))*degradi;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                    vecstrd(az, dp, pt);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    <span class="comment">//cblas_dgemv(CblasColMajor, CblasNoTrans, 3, 3,</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    <span class="comment">//            1.0, tm, 3, pt, 1, 0.0, ptnew, 1);</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    gemv3(tm, pt, ptnew);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                    plusMin = dot3(pt, ptnew);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                    pn1[k] =-1;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    <span class="keywordflow">if</span> (plusMin &gt; 100.0*DBL_EPSILON*ampMax){pn1[k] = 1;}</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                } <span class="comment">// end check on location</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            } <span class="comment">// loop on x</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        } <span class="comment">// loop on y</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="comment">// Copy the points to be plotted</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keywordflow">if</span> (nwork &gt; 0)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ae2c993a67248339ca041a2daf13fcf89">npolarity</a> = (int) nwork;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a5d16c92e39b01e34aa44dc0fba4fcd9d">xPolarity</a> = (<span class="keywordtype">double</span> *)</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                   calloc((<span class="keywordtype">size_t</span>) nwork, <span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a098567845b40d00d3bac256a61916c21">yPolarity</a> = (<span class="keywordtype">double</span> *)</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                   calloc((<span class="keywordtype">size_t</span>) nwork, <span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#af23ae8fe9b61d7f66813fdb9f93daaf3">polarity</a> = (<span class="keywordtype">int</span> *)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                  calloc((<span class="keywordtype">size_t</span>) nwork, <span class="keyword">sizeof</span>(double));</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            k = 0; </div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <span class="keywordflow">for</span> (ixy=0; ixy&lt;nx*ny;  ixy++)</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            {</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                <span class="keywordflow">if</span> (pn1[ixy] != 0)</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                    beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a5d16c92e39b01e34aa44dc0fba4fcd9d">xPolarity</a>[k] = xw1[ixy];</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                    beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a098567845b40d00d3bac256a61916c21">yPolarity</a>[k] = yw1[ixy];</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#af23ae8fe9b61d7f66813fdb9f93daaf3">polarity</a>[k] = pn1[ixy];</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                    k = k + 1;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            }</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        }</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        free(pn1);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        free(xw1);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        free(yw1);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    }</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;}</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno"><a class="line" href="beachball_8h.html#acebc8325fc27dd441e210779f534d77e">  986</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="beachball_8c.html#acebc8325fc27dd441e210779f534d77e">cliffsNodes_free</a>(<span class="keyword">struct</span> <a class="code" href="structbeach_ball__struct.html">beachBall_struct</a> *beachBall)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;{</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">xNodalLine1</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">xNodalLine1</a>);}</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">yNodalLine1</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">yNodalLine1</a>);}</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">xNodalLine2</a>);}</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">yNodalLine2</a>);}</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad85c80e168676b8e530babeb8696c939">xFocalSphere</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#ad85c80e168676b8e530babeb8696c939">xFocalSphere</a>);}</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a9fa03171ed7fd073882543c4a26fb6b8">yFocalSphere</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a9fa03171ed7fd073882543c4a26fb6b8">yFocalSphere</a>);}</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a5d16c92e39b01e34aa44dc0fba4fcd9d">xPolarity</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a5d16c92e39b01e34aa44dc0fba4fcd9d">xPolarity</a>);}</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a098567845b40d00d3bac256a61916c21">yPolarity</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#a098567845b40d00d3bac256a61916c21">yPolarity</a>);}</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#af23ae8fe9b61d7f66813fdb9f93daaf3">polarity</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#af23ae8fe9b61d7f66813fdb9f93daaf3">polarity</a>);}</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#aed28f64861afc74fcac34db801f2fe3e">nodalLine1Ptr</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#aed28f64861afc74fcac34db801f2fe3e">nodalLine1Ptr</a>);}</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordflow">if</span> (beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#aeca1929302c7683f529bbaf185bf8cdc">nodalLine2Ptr</a> != NULL){free(beachBall-&gt;<a class="code" href="structbeach_ball__struct.html#aeca1929302c7683f529bbaf185bf8cdc">nodalLine2Ptr</a>);}</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    memset(beachBall, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structbeach_ball__struct.html">beachBall_struct</a>));</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;}</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">//============================================================================//</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> rotmat(<span class="keyword">const</span> <span class="keywordtype">int</span> naxis, <span class="keyword">const</span> <span class="keywordtype">double</span> theta,</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                   <span class="keywordtype">double</span> *__restrict__ r,</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                   <span class="keywordtype">double</span> *__restrict__ rt)</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;{</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordtype">double</span> cosThetar, sinThetar, thetar;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordtype">int</span> i, j;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> degrad = <a class="code" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    memset(r, 0, 9*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    thetar = theta*degrad;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    cosThetar = cos(thetar); </div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    sinThetar = sin(thetar);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    r[0] = cosThetar;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    r[4] = cosThetar;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    r[8] = cosThetar;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">// naxis = x</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">if</span> (naxis == 1)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    {</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        r[0] = 1.0;       <span class="comment">// (1, 1)</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        r[5] = sinThetar; <span class="comment">// (3, 2)</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        r[7] =-sinThetar; <span class="comment">// (2, 3)</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">// naxis = y</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (naxis == 2)</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        r[2] = sinThetar; <span class="comment">// (3, 1)</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        r[4] = 1.0;       <span class="comment">// (2, 2)</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        r[6] =-sinThetar; <span class="comment">// (1, 3)</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="comment">// naxis = z</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (naxis == 3)</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        r[1] = sinThetar; <span class="comment">// (2, 1)</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        r[3] =-sinThetar; <span class="comment">// (1, 2)</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        r[8] = 1.0;       <span class="comment">// (3, 3)</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    }</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">// Compute the transpose   </span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;3; i++)</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    {</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;3; j++)</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        {</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            rt[3*i+j] = r[3*j+i];</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;}</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">//============================================================================//</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> vecstrd(<span class="keyword">const</span> <span class="keywordtype">double</span> str, <span class="keyword">const</span> <span class="keywordtype">double</span> dip, <span class="keywordtype">double</span> r[3])</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;{</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordtype">double</span> cosdip, cosstr, diprad, sindip, sinstr, strrad;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> degrad = <a class="code" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">// convert to radians</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    strrad = str*degrad;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    diprad = dip*degrad;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="comment">// compute cosines and sines</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    sinstr = sin(strrad);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    cosstr = cos(strrad);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    cosdip = cos(diprad);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    sindip = sin(diprad);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="comment">// compute (x,y,z) from strike and dip for unit radius </span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    r[0] = sinstr*cosdip;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    r[1] = cosstr*cosdip;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    r[2] =-sindip;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;}</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">//============================================================================//</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> isItNear(<span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ pt,</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                     <span class="keywordtype">double</span> *howClose,</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                     <span class="keywordtype">double</span> *__restrict__ ptold)</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;{</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    *howClose = dot3(ptold, pt); <span class="comment">//cblas_ddot(3, ptold, 1, pt, 1); </span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    ptold[0] = pt[0];</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    ptold[1] = pt[1];</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    ptold[2] = pt[2];</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;}</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> strdvec(<span class="keywordtype">double</span> r[3], <span class="keywordtype">double</span> *str, <span class="keywordtype">double</span> *dip)</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;{</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordtype">double</span> rs;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> degradi = 180.0/<a class="code" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordflow">if</span> (r[2] &gt; 0.0)</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        r[0] =-r[0];</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        r[1] =-r[1];</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        r[2] =-r[2];</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    }</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    *str = atan2(r[0], r[1])*degradi;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">if</span> (*str &lt; 0.){*str = *str + 360.;}</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    rs = sqrt(r[0]*r[0] + r[1]*r[1]);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    *dip=atan2(-r[2], rs)*degradi;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;}</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> crossp(<span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ u,</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ v,</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                   <span class="keywordtype">double</span> *__restrict__ n)</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;{</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    n[0] = u[1]*v[2] - u[2]*v[1];</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    n[1] = u[2]*v[0] - u[0]*v[2]; </div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    n[2] = u[0]*v[1] - u[1]*v[0];</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;}</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> strdv(<span class="keyword">const</span> <span class="keywordtype">double</span> r[3], <span class="keywordtype">double</span> *str, <span class="keywordtype">double</span> *dip)</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;{</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordtype">double</span> rs;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> degradi = 180.0/<a class="code" href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    *str = atan2(r[0], r[1])*degradi;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    rs = sqrt(r[0]*r[0] + r[1]*r[1]);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    *dip = atan2(-r[2], rs)*degradi;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;}</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> dot3(<span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ x,</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ y)</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;{</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordtype">double</span> dot;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    dot = x[0]*y[0] + x[1]*y[1] + x[2]*y[2];</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">return</span> dot;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;}</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> gemv3(<span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ A, <span class="keyword">const</span> <span class="keywordtype">double</span> *__restrict__ x,</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                  <span class="keywordtype">double</span> *__restrict__ y)</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;{</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    y[0] = A[0]*x[0] + A[3]*x[1] + A[6]*x[2];</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    y[1] = A[1]*x[0] + A[4]*x[1] + A[7]*x[2];</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    y[2] = A[2]*x[0] + A[5]*x[1] + A[8]*x[2];</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;}</div><div class="ttc" id="structbeach_ball__struct_html_a35bc938a1431f6da372d7522672510fb"><div class="ttname"><a href="structbeach_ball__struct.html#a35bc938a1431f6da372d7522672510fb">beachBall_struct::xNodalLine2</a></div><div class="ttdeci">double * xNodalLine2</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00010">beachball.h:10</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ad64a753b0b96448e6fafb8b9d20c26e0"><div class="ttname"><a href="structbeach_ball__struct.html#ad64a753b0b96448e6fafb8b9d20c26e0">beachBall_struct::yt</a></div><div class="ttdeci">double yt</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00027">beachball.h:27</a></div></div>
<div class="ttc" id="beachball_8c_html_a394f716524aaf5687a294a614b85a2d8"><div class="ttname"><a href="beachball_8c.html#a394f716524aaf5687a294a614b85a2d8">cliffsNodes_mtensor</a></div><div class="ttdeci">void cliffsNodes_mtensor(const double taz, const double tdp, const double paz, const double pdp, const double tev1, const double bev1, const double pev1, double *__restrict__ mt, double *__restrict__ rm, double *__restrict__ rmt, double *ampMax)</div><div class="ttdoc">Given the azimuth and dip of the tension and pressure eigenvectors in geographic coordinates along wi...</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00510">beachball.c:510</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_a5d16c92e39b01e34aa44dc0fba4fcd9d"><div class="ttname"><a href="structbeach_ball__struct.html#a5d16c92e39b01e34aa44dc0fba4fcd9d">beachBall_struct::xPolarity</a></div><div class="ttdeci">double * xPolarity</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00014">beachball.h:14</a></div></div>
<div class="ttc" id="beachball_8c_html_acebc8325fc27dd441e210779f534d77e"><div class="ttname"><a href="beachball_8c.html#acebc8325fc27dd441e210779f534d77e">cliffsNodes_free</a></div><div class="ttdeci">void cliffsNodes_free(struct beachBall_struct *beachBall)</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00986">beachball.c:986</a></div></div>
<div class="ttc" id="beachball_8c_html_aee0f6746393f5d6284fc925237f39703"><div class="ttname"><a href="beachball_8c.html#aee0f6746393f5d6284fc925237f39703">cliffsNodes_plotStations</a></div><div class="ttdeci">int cliffsNodes_plotStations(const double xc, const double yc, const double rad, const int nstat, const double *__restrict__ az, const double *__restrict__ toa, double *__restrict__ xp, double *__restrict__ yp)</div><div class="ttdoc">Computes the station locations for the given azimuth and take-off angle on a focal sphere with radius...</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00441">beachball.c:441</a></div></div>
<div class="ttc" id="beachball_8c_html_ac7c2236111e9175c69d730131a8df4c9"><div class="ttname"><a href="beachball_8c.html#ac7c2236111e9175c69d730131a8df4c9">cliffsNodes_beachBallP</a></div><div class="ttdeci">void cliffsNodes_beachBallP(const double xc, const double yc, const double rad, const double taz1, const double tdp1, const double tevI, const double baz1, const double bdp1, const double bevI, const double paz1, const double pdp1, const double pevI, const int nNodalLine, const int nFocalSphere, const int nxPixel, const int nyPixel, const bool lwantNodalLines, const bool lwantPTBAxes, const bool lwantPolarity, struct beachBall_struct *beachBall)</div><div class="ttdoc">Computes the lower-hemisphere projection `beachball&amp;#39; diagram for a focal mechanism. This is based on Cliff Frohlich&amp;#39;s bballP and has been translated to C and does no plotting. </div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00601">beachball.c:601</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_a098567845b40d00d3bac256a61916c21"><div class="ttname"><a href="structbeach_ball__struct.html#a098567845b40d00d3bac256a61916c21">beachBall_struct::yPolarity</a></div><div class="ttdeci">double * yPolarity</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00015">beachball.h:15</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_af649efec4c4f51f4db0ebb935a83d015"><div class="ttname"><a href="structbeach_ball__struct.html#af649efec4c4f51f4db0ebb935a83d015">beachBall_struct::xp</a></div><div class="ttdeci">double xp</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00022">beachball.h:22</a></div></div>
<div class="ttc" id="beachball_8c_html_a9dbfc6f1d8212299d3dd78fdf70766fb"><div class="ttname"><a href="beachball_8c.html#a9dbfc6f1d8212299d3dd78fdf70766fb">beachball_setMomentTensor</a></div><div class="ttdeci">int beachball_setMomentTensor(const double m11, const double m22, const double m33, const double m12, const double m13, const double m23, const enum cmopad_basis_enum basis, struct beachballPlot_struct *beachball)</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00057">beachball.c:57</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ab489a45cef8599c5fc11611b3c71dedc"><div class="ttname"><a href="structbeach_ball__struct.html#ab489a45cef8599c5fc11611b3c71dedc">beachBall_struct::yNodalLine2</a></div><div class="ttdeci">double * yNodalLine2</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00011">beachball.h:11</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_a67ceb94f2cf4f755e4d8703624ba447e"><div class="ttname"><a href="structbeachball_plot__struct.html#a67ceb94f2cf4f755e4d8703624ba447e">beachballPlot_struct::lwantNodalLines</a></div><div class="ttdeci">bool lwantNodalLines</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00050">beachball.h:50</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html"><div class="ttname"><a href="structbeach_ball__struct.html">beachBall_struct</a></div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00006">beachball.h:6</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_a276b94cba51eecc167fd0fb0bb94b708"><div class="ttname"><a href="structbeachball_plot__struct.html#a276b94cba51eecc167fd0fb0bb94b708">beachballPlot_struct::nxPixel</a></div><div class="ttdeci">int nxPixel</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00045">beachball.h:45</a></div></div>
<div class="ttc" id="cmopad_8h_html_a493c4b9712b7f16e63fa48923ac8e51fac25a68be23c83a9b7aee463b31527508"><div class="ttname"><a href="cmopad_8h.html#a493c4b9712b7f16e63fa48923ac8e51fac25a68be23c83a9b7aee463b31527508">NED</a></div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8h_source.html#l00045">cmopad.h:45</a></div></div>
<div class="ttc" id="cmopad_8c_html_aa193d08b096c71d5b0a812e76eae1122"><div class="ttname"><a href="cmopad_8c.html#aa193d08b096c71d5b0a812e76eae1122">cmopad_basis_transformMatrixM33</a></div><div class="ttdeci">int cmopad_basis_transformMatrixM33(double m[3][3], enum cmopad_basis_enum in_sys, enum cmopad_basis_enum out_sys)</div><div class="ttdoc">Transform a symmetric 3x3 matrix from in_sys to out_sys. </div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8c_source.html#l00216">cmopad.c:216</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_ad6bdeeca57359c5bb4a13bf52933cca6"><div class="ttname"><a href="structbeachball_plot__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">beachballPlot_struct::nFocalSphere</a></div><div class="ttdeci">int nFocalSphere</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00048">beachball.h:48</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html"><div class="ttname"><a href="structbeachball_plot__struct.html">beachballPlot_struct</a></div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00039">beachball.h:39</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ada579aea1b865d64386b70b0f42c65d2"><div class="ttname"><a href="structbeach_ball__struct.html#ada579aea1b865d64386b70b0f42c65d2">beachBall_struct::nNodalLineSegs2</a></div><div class="ttdeci">int nNodalLineSegs2</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00030">beachball.h:30</a></div></div>
<div class="ttc" id="beachball_8c_html_a328742b602af65206e7a7f17d577003a"><div class="ttname"><a href="beachball_8c.html#a328742b602af65206e7a7f17d577003a">PIXMAP_COLORS</a></div><div class="ttdeci">#define PIXMAP_COLORS</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00035">beachball.c:35</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ab49a92d33ce4f0824e66094c8b3f3153"><div class="ttname"><a href="structbeach_ball__struct.html#ab49a92d33ce4f0824e66094c8b3f3153">beachBall_struct::xNodalLine1</a></div><div class="ttdeci">double * xNodalLine1</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00008">beachball.h:8</a></div></div>
<div class="ttc" id="structcmopad__struct_html_a4dd2b1fb1d0c678e079f97c22336ad37"><div class="ttname"><a href="structcmopad__struct.html#a4dd2b1fb1d0c678e079f97c22336ad37">cmopad_struct::t_axis</a></div><div class="ttdeci">double t_axis[3]</div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8h_source.html#l00021">cmopad.h:21</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_a5b5d4f3c9ef8cbf20bff18ddd1b04609"><div class="ttname"><a href="structbeach_ball__struct.html#a5b5d4f3c9ef8cbf20bff18ddd1b04609">beachBall_struct::xt</a></div><div class="ttdeci">double xt</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00026">beachball.h:26</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ad986f10526b97fa59b5ecd6c7ff8f77d"><div class="ttname"><a href="structbeach_ball__struct.html#ad986f10526b97fa59b5ecd6c7ff8f77d">beachBall_struct::yNodalLine1</a></div><div class="ttdeci">double * yNodalLine1</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00009">beachball.h:9</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_a566f05b021d16dd00591f9dbe9357463"><div class="ttname"><a href="structbeachball_plot__struct.html#a566f05b021d16dd00591f9dbe9357463">beachballPlot_struct::cmt</a></div><div class="ttdeci">struct cmopad_struct cmt</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00041">beachball.h:41</a></div></div>
<div class="ttc" id="gfast__config_8h_html"><div class="ttname"><a href="gfast__config_8h.html">gfast_config.h</a></div></div>
<div class="ttc" id="beachball_8c_html_a74e75242132eaabbc1c512488a135926"><div class="ttname"><a href="beachball_8c.html#a74e75242132eaabbc1c512488a135926">MIN</a></div><div class="ttdeci">#define MIN(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00033">beachball.c:33</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ad85c80e168676b8e530babeb8696c939"><div class="ttname"><a href="structbeach_ball__struct.html#ad85c80e168676b8e530babeb8696c939">beachBall_struct::xFocalSphere</a></div><div class="ttdeci">double * xFocalSphere</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00012">beachball.h:12</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_a9037c106a7918beb799a798569952e16"><div class="ttname"><a href="structbeachball_plot__struct.html#a9037c106a7918beb799a798569952e16">beachballPlot_struct::nNodalLine</a></div><div class="ttdeci">int nNodalLine</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00047">beachball.h:47</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_abaefdeffb1a6c37ecbbba1abe183a288"><div class="ttname"><a href="structbeachball_plot__struct.html#abaefdeffb1a6c37ecbbba1abe183a288">beachballPlot_struct::xc</a></div><div class="ttdeci">double xc</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00043">beachball.h:43</a></div></div>
<div class="ttc" id="beachball_8c_html_a958e4508ed28ee5cc04249144312c15f"><div class="ttname"><a href="beachball_8c.html#a958e4508ed28ee5cc04249144312c15f">M_PI_2</a></div><div class="ttdeci">#define M_PI_2</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00027">beachball.c:27</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_ab6c28cf69c9a69a01e7ea6a37c85ba92"><div class="ttname"><a href="structbeachball_plot__struct.html#ab6c28cf69c9a69a01e7ea6a37c85ba92">beachballPlot_struct::rad</a></div><div class="ttdeci">double rad</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00042">beachball.h:42</a></div></div>
<div class="ttc" id="beachball_8c_html_aacc3ee1a7f283f8ef65cea31f4436a95"><div class="ttname"><a href="beachball_8c.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a></div><div class="ttdeci">#define MAX(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00030">beachball.c:30</a></div></div>
<div class="ttc" id="beachball_8h_html"><div class="ttname"><a href="beachball_8h.html">beachball.h</a></div></div>
<div class="ttc" id="cmopad_8c_html_ae9fa0569fb8fbbf71816d1680376bdef"><div class="ttname"><a href="cmopad_8c.html#ae9fa0569fb8fbbf71816d1680376bdef">cmopad_standardDecomposition</a></div><div class="ttdeci">int cmopad_standardDecomposition(double Min[3][3], struct cmopad_struct *src)</div><div class="ttdoc">Decomposes the input moment tensor Min in the North, East, Down coordinates into an isotropic...</div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8c_source.html#l01348">cmopad.c:1348</a></div></div>
<div class="ttc" id="cmopad_8c_html_ac72abee829040dcace74a0e66bd13be3"><div class="ttname"><a href="cmopad_8c.html#ac72abee829040dcace74a0e66bd13be3">cmopad_Eigenvector2PrincipalAxis</a></div><div class="ttdeci">int cmopad_Eigenvector2PrincipalAxis(enum cmopad_basis_enum coord, double eig, double ev[3], double paxis[3])</div><div class="ttdoc">Converts the unit eigenvector of length eig in coordinate system coord to length, azimuth...</div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8c_source.html#l00358">cmopad.c:358</a></div></div>
<div class="ttc" id="cmopad_8c_html_a1e15943c3bc19d926e75d06d03472576"><div class="ttname"><a href="cmopad_8c.html#a1e15943c3bc19d926e75d06d03472576">cmopad_MT2PrincipalAxisSystem</a></div><div class="ttdeci">int cmopad_MT2PrincipalAxisSystem(int iverb, struct cmopad_struct *src)</div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8c_source.html#l00803">cmopad.c:803</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_a5f2dee54ae7b27277545443af6fda96a"><div class="ttname"><a href="structbeachball_plot__struct.html#a5f2dee54ae7b27277545443af6fda96a">beachballPlot_struct::lwantPolarity</a></div><div class="ttdeci">bool lwantPolarity</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00049">beachball.h:49</a></div></div>
<div class="ttc" id="structcmopad__struct_html_ad3d5d54e4aada8f0df5f9a8fcf553637"><div class="ttname"><a href="structcmopad__struct.html#ad3d5d54e4aada8f0df5f9a8fcf553637">cmopad_struct::eig_pnt</a></div><div class="ttdeci">double eig_pnt[3]</div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8h_source.html#l00018">cmopad.h:18</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_af9c2064dfe08800eed3ef0b747b7c892"><div class="ttname"><a href="structbeachball_plot__struct.html#af9c2064dfe08800eed3ef0b747b7c892">beachballPlot_struct::nyPixel</a></div><div class="ttdeci">int nyPixel</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00046">beachball.h:46</a></div></div>
<div class="ttc" id="structcmopad__struct_html"><div class="ttname"><a href="structcmopad__struct.html">cmopad_struct</a></div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8h_source.html#l00005">cmopad.h:5</a></div></div>
<div class="ttc" id="beachball_8c_html_a1473891ec4d8ea3e50df08eef9d1d6b8"><div class="ttname"><a href="beachball_8c.html#a1473891ec4d8ea3e50df08eef9d1d6b8">beachball_plotDefaults</a></div><div class="ttdeci">int beachball_plotDefaults(struct beachballPlot_struct *beachball)</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00385">beachball.c:385</a></div></div>
<div class="ttc" id="structcmopad__struct_html_afbb9fd85fd66e890203344fda2f250bc"><div class="ttname"><a href="structcmopad__struct.html#afbb9fd85fd66e890203344fda2f250bc">cmopad_struct::eigenvalues</a></div><div class="ttdeci">double eigenvalues[3]</div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8h_source.html#l00017">cmopad.h:17</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_af23ae8fe9b61d7f66813fdb9f93daaf3"><div class="ttname"><a href="structbeach_ball__struct.html#af23ae8fe9b61d7f66813fdb9f93daaf3">beachBall_struct::polarity</a></div><div class="ttdeci">int * polarity</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00016">beachball.h:16</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_a31d2d6327e76038cd2aee5b972f6a9b3"><div class="ttname"><a href="structbeachball_plot__struct.html#a31d2d6327e76038cd2aee5b972f6a9b3">beachballPlot_struct::yc</a></div><div class="ttdeci">double yc</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00044">beachball.h:44</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_a9fa03171ed7fd073882543c4a26fb6b8"><div class="ttname"><a href="structbeach_ball__struct.html#a9fa03171ed7fd073882543c4a26fb6b8">beachBall_struct::yFocalSphere</a></div><div class="ttdeci">double * yFocalSphere</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00013">beachball.h:13</a></div></div>
<div class="ttc" id="cmopad_8h_html"><div class="ttname"><a href="cmopad_8h.html">cmopad.h</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_aeca1929302c7683f529bbaf185bf8cdc"><div class="ttname"><a href="structbeach_ball__struct.html#aeca1929302c7683f529bbaf185bf8cdc">beachBall_struct::nodalLine2Ptr</a></div><div class="ttdeci">int * nodalLine2Ptr</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00020">beachball.h:20</a></div></div>
<div class="ttc" id="beachball_8c_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="beachball_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00024">beachball.c:24</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ae2c993a67248339ca041a2daf13fcf89"><div class="ttname"><a href="structbeach_ball__struct.html#ae2c993a67248339ca041a2daf13fcf89">beachBall_struct::npolarity</a></div><div class="ttdeci">int npolarity</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00034">beachball.h:34</a></div></div>
<div class="ttc" id="beachball_8c_html_a8dad4077a4721003bfe4f652ec2d0609"><div class="ttname"><a href="beachball_8c.html#a8dad4077a4721003bfe4f652ec2d0609">beachball_draw</a></div><div class="ttdeci">int beachball_draw(const char *fileName, struct beachballPlot_struct beachball)</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00182">beachball.c:182</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_a7841edcbdbfea2b400dea7753dcfac9e"><div class="ttname"><a href="structbeach_ball__struct.html#a7841edcbdbfea2b400dea7753dcfac9e">beachBall_struct::yp</a></div><div class="ttdeci">double yp</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00023">beachball.h:23</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_a363478c63dde84a67ebcd5d3ca1fbda2"><div class="ttname"><a href="structbeach_ball__struct.html#a363478c63dde84a67ebcd5d3ca1fbda2">beachBall_struct::yb</a></div><div class="ttdeci">double yb</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00025">beachball.h:25</a></div></div>
<div class="ttc" id="structcmopad__struct_html_aa87c78cc398ae1e60f4e584dfbb3aaab"><div class="ttname"><a href="structcmopad__struct.html#aa87c78cc398ae1e60f4e584dfbb3aaab">cmopad_struct::p_axis</a></div><div class="ttdeci">double p_axis[3]</div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8h_source.html#l00022">cmopad.h:22</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ae5118884cd104f1662bad29cd32bb2aa"><div class="ttname"><a href="structbeach_ball__struct.html#ae5118884cd104f1662bad29cd32bb2aa">beachBall_struct::nNodalLineSegs1</a></div><div class="ttdeci">int nNodalLineSegs1</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00028">beachball.h:28</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ae78ecf4e64643bcfc6a3b4405d856f5c"><div class="ttname"><a href="structbeach_ball__struct.html#ae78ecf4e64643bcfc6a3b4405d856f5c">beachBall_struct::xb</a></div><div class="ttdeci">double xb</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00024">beachball.h:24</a></div></div>
<div class="ttc" id="structcmopad__struct_html_aa32887859c59d9f2fd0bdcadeb64c0e3"><div class="ttname"><a href="structcmopad__struct.html#aa32887859c59d9f2fd0bdcadeb64c0e3">cmopad_struct::null_axis</a></div><div class="ttdeci">double null_axis[3]</div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8h_source.html#l00020">cmopad.h:20</a></div></div>
<div class="ttc" id="cmopad_8h_html_a493c4b9712b7f16e63fa48923ac8e51f"><div class="ttname"><a href="cmopad_8h.html#a493c4b9712b7f16e63fa48923ac8e51f">cmopad_basis_enum</a></div><div class="ttdeci">cmopad_basis_enum</div><div class="ttdef"><b>Definition:</b> <a href="cmopad_8h_source.html#l00043">cmopad.h:43</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_aed28f64861afc74fcac34db801f2fe3e"><div class="ttname"><a href="structbeach_ball__struct.html#aed28f64861afc74fcac34db801f2fe3e">beachBall_struct::nodalLine1Ptr</a></div><div class="ttdeci">int * nodalLine1Ptr</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00018">beachball.h:18</a></div></div>
<div class="ttc" id="beachball_8c_html_af6b12ad0072637f30c4449c88757f76c"><div class="ttname"><a href="beachball_8c.html#af6b12ad0072637f30c4449c88757f76c">beachball_writePNG</a></div><div class="ttdeci">int beachball_writePNG(const char *fileName, size_t height, size_t width, unsigned char *bytes)</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8c_source.html#l00149">beachball.c:149</a></div></div>
<div class="ttc" id="structbeach_ball__struct_html_ad6bdeeca57359c5bb4a13bf52933cca6"><div class="ttname"><a href="structbeach_ball__struct.html#ad6bdeeca57359c5bb4a13bf52933cca6">beachBall_struct::nFocalSphere</a></div><div class="ttdeci">int nFocalSphere</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00032">beachball.h:32</a></div></div>
<div class="ttc" id="structbeachball_plot__struct_html_a52469b7999db5653ce2b025951668210"><div class="ttname"><a href="structbeachball_plot__struct.html#a52469b7999db5653ce2b025951668210">beachballPlot_struct::lhaveMT</a></div><div class="ttdeci">bool lhaveMT</div><div class="ttdef"><b>Definition:</b> <a href="beachball_8h_source.html#l00051">beachball.h:51</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c1c6716db148f6a3044f992f7b92cbeb.html">uw</a></li><li class="navelem"><a class="el" href="beachball_8c.html">beachball.c</a></li>
    <li class="footer">Generated on Wed Aug 2 2017 12:35:02 for GFAST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
