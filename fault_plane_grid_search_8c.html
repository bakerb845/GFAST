<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>GFAST: src/core/ff/faultPlaneGridSearch.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pnsn_icon.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFAST
   &#160;<span id="projectnumber">v0.01</span>
   </div>
   <div id="projectbrief">Fast geodetic computations for earthquake early warning</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('fault_plane_grid_search_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">faultPlaneGridSearch.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="gfast__core_8h_source.html">gfast_core.h</a>&quot;</code><br />
<code>#include &lt;lapacke.h&gt;</code><br />
<code>#include &lt;cblas.h&gt;</code><br />
<code>#include &quot;iscl/linalg/linalg.h&quot;</code><br />
<code>#include &quot;iscl/log/log.h&quot;</code><br />
<code>#include &quot;iscl/time/time.h&quot;</code><br />
<code>#include &quot;iscl/memory/memory.h&quot;</code><br />
</div>
<p><a href="fault_plane_grid_search_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a36122e46021db03e8733fcf9806d6665"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fault_plane_grid_search_8c.html#a36122e46021db03e8733fcf9806d6665">core_ff_faultPlaneGridSearch</a> (const int l1, const int l2, const int nstr, const int ndip, const int nfp, const int verbose, const double *__restrict__ nObsOffset, const double *__restrict__ eObsOffset, const double *__restrict__ uObsOffset, const double *__restrict__ nWts, const double *__restrict__ eWts, const double *__restrict__ uWts, const double *__restrict__ utmRecvEasting, const double *__restrict__ utmRecvNorthing, const double *__restrict__ staAlt, const double *__restrict__ fault_xutm, const double *__restrict__ fault_yutm, const double *__restrict__ fault_alt, const double *__restrict__ length, const double *__restrict__ width, const double *__restrict__ strike, const double *__restrict__ dip, double *__restrict__ sslip, double *__restrict__ dslip, double *__restrict__ Mw, double *__restrict__ vr, double *__restrict__ NN, double *__restrict__ EN, double *__restrict__ UN, double *__restrict__ sslip_unc, double *__restrict__ dslip_unc)</td></tr>
<tr class="memdesc:a36122e46021db03e8733fcf9806d6665"><td class="mdescLeft">&#160;</td><td class="mdescRight">This performs the grid-search finite-fault slip inversion for the given fault planes.  <a href="#a36122e46021db03e8733fcf9806d6665">More...</a><br /></td></tr>
<tr class="separator:a36122e46021db03e8733fcf9806d6665"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a36122e46021db03e8733fcf9806d6665"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int core_ff_faultPlaneGridSearch </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>l1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>l2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ndip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>nObsOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>eObsOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>uObsOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>nWts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>eWts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>uWts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>utmRecvEasting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>utmRecvNorthing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>staAlt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>fault_xutm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>fault_yutm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>fault_alt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>strike</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *__restrict__&#160;</td>
          <td class="paramname"><em>dip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>sslip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>dslip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>Mw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>vr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>NN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>EN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>UN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>sslip_unc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *__restrict__&#160;</td>
          <td class="paramname"><em>dslip_unc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This performs the grid-search finite-fault slip inversion for the given fault planes. </p>
<dl class="section note"><dt>Note</dt><dd>The fault plane arrays (e.g. fault_xutm, fault_yutm, fault_alt, length, width, strike, dip, sslip, dslip, sslip_unc, dslip_unc) are packed such that the istr'th, idip'th element on the ifp'th fault plane is given ifp*l2 + idip*nstr + istr by where l2 = nstr*ndip. Similarly, the estimate displacement in the NN, EN, and UN for the i'th site for the ifp'th fault plane is given by ifp*l1 + i where l1 is the number of sites in the inversion.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">l1</td><td>number of sites in the inversion. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">l2</td><td>leading dimension for the fault plane information. this must be nstr*ndip. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nstr</td><td>number of elements along strike in each fault plane. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ndip</td><td>number of elements down dip in each fault plane. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nfp</td><td>number of fault planes in grid-search </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>controls verbosity (0 will only report on errors) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nObsOffset</td><td>the observed offset (m) in the north component for the i'th site [l1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eObsOffset</td><td>the observed offset (m) in the east component for the i'th site [l1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uObsOffset</td><td>the observed offset (m) in the vertical component for the i'th site [l1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nWts</td><td>data weight on the i'th north observation [l1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eWts</td><td>data weight on the i'th east observation [l1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uWts</td><td>data weight on the i'th vertical observation [l1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">utmRecvEasting</td><td>the UTM easting location (m) of the i'th site [l1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">utmRecvNorthing</td><td>the UTM northing location (m) of the i'th site [l1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">staAlt</td><td>altitude (m) of i'th site above sea-level [l1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fault_xutm</td><td>the UTM x (east) location (m) of the if'th fault patch on the ifp'th fault plane [l2*nfp]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fault_yutm</td><td>the UTM y (north) location (m) of the if'th fault patch on the ifp'th fault plane [l2*nfp]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fault_alt</td><td>depth (km) of the if'th fault patch on the ifp'th fault plane [l2*nfp]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length</td><td>the length (m) of the if'th fault patch on the ifp'th fault plane [l2*nfp]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">width</td><td>the width (m) of the if'th fault patch on the ifp'th fault plane [l2*nfp]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">strike</td><td>the strike angle (degrees) of the if'th fault patch on the ifp'th fault plane [l2*nfp]. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dip</td><td>the dip angle (degrees) of the if'th fault patch on the ifp'th fault plane [l2*nfp].</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sslip</td><td>slip along strike (m) on the if'th fault patch on the ifp'th fault plane [l2*nfp]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dslip</td><td>slip down dip (m) on the if'th fault patch of the ifp'th fault plane [l2*nfp]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Mw</td><td>moment magnitude for the event on the ifp'th fault plane [nfp]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vr</td><td>the variance reduction for the linearized slip inversion on the ifp'th fault plane [nfp] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NN</td><td>the estimated displacement in the north component (m) for the i'th site on the ifp'th fault plane [l1*nfp]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">EN</td><td>the estimated displacement in the east component (m) for the i'th site on the ifp'th fault plane [11*nfp]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">UN</td><td>the estimated displacement in the the vertical component (m) for the i'th site on the ifp'th fault plane [l1*nfp].</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sslip_unc</td><td>if not NULL then this is the uncertainty (m) estimated from the diagonal of the model covariance matrix for the slip along strike on the if'th fault patch on the ifp'th fault plane [l2*nfp] </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dslip_unc</td><td>if not NULL then this is the uncertainty (m) estimated from the diagonal of the model covariance matrix for the slip down dip on the on the if'th fault patch on the ifp'th fault plane [l2*nfp]</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 indicates success.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Brendan Crowell (PNSN) and Ben Baker (ISTI)</dd></dl>
<dl class="section date"><dt>Date</dt><dd>May 2016 </dd></dl>

<p>Definition at line <a class="el" href="fault_plane_grid_search_8c_source.html#l00105">105</a> of file <a class="el" href="fault_plane_grid_search_8c_source.html">faultPlaneGridSearch.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fault_plane_grid_search_8c_a36122e46021db03e8733fcf9806d6665_cgraph.png" border="0" usemap="#fault_plane_grid_search_8c_a36122e46021db03e8733fcf9806d6665_cgraph" alt=""/></div>
<map name="fault_plane_grid_search_8c_a36122e46021db03e8733fcf9806d6665_cgraph" id="fault_plane_grid_search_8c_a36122e46021db03e8733fcf9806d6665_cgraph">
<area shape="rect" id="node2" href="ff_2set_r_h_s_8c.html#a37310af3d627e5122beeaea7a0b6451f" title="Sets the RHS for the finite fault inversion. The right hand side for the i&#39;th site is packed ..." alt="" coords="282,5,398,32"/>
<area shape="rect" id="node3" href="ff_2set_diagonal_weight_matrix_8c.html#ac60f657f7cb0f7342b1ea387402dc124" title="Sets the diagonal weight matrix in the inversion. " alt="" coords="251,57,429,98"/>
<area shape="rect" id="node4" href="ff_2weight_observations_8c.html#a0fc774e1f5b8d12567123b8dd08d4fff" title="Applies the diagonal data weight matrix to the observations. " alt="" coords="248,123,432,149"/>
<area shape="rect" id="node5" href="ff_2set_forward_model_8c.html#a716f3739cbae2ec2616b4040796cf7f4" title="This program computes the Green&#39;s functions from Okada&#39;s formulation for slip on fault patches at a s..." alt="" coords="255,174,425,215"/>
<area shape="rect" id="node6" href="ff_2weight_forward_model_8c.html#a7c1804721e00ff48deaa956a14b82ae9" title="Weights a forward modeling matrix by the diagonal data weights. " alt="" coords="245,240,435,267"/>
<area shape="rect" id="node7" href="set_regularizer_8c.html#a43058fbd923650fb9b66c190329ce4be" title="Computes the second order Tikhonov regularizer along strike and down dip for estimation of the slip a..." alt="" coords="263,291,417,317"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_e0cce9a825eac212250812ef251cad84.html">ff</a></li><li class="navelem"><a class="el" href="fault_plane_grid_search_8c.html">faultPlaneGridSearch.c</a></li>
    <li class="footer">Generated on Wed Aug 2 2017 12:35:02 for GFAST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
